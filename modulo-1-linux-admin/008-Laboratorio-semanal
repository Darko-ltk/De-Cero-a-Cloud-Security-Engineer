D√çA 8: REPASO Y LABORATORIO INTEGRADOR SEMANAL

Objetivo: Consolidar conocimientos de la primera semana mediante un laboratorio pr√°ctico que simule la configuraci√≥n completa de un servidor base

METODOLOG√çA DE CONSOLIDACI√ìN
¬øPor qu√© un Laboratorio Integrador?
Despu√©s de 7 d√≠as de aprendizaje intensivo, tu cerebro necesita consolidar los conocimientos adquiridos. Como futuro Cloud Security Engineer, no basta con conocer comandos aislados; debes ser capaz de integrar todas las habilidades en un flujo de trabajo coherente que refleje escenarios reales de la industria.
Beneficios del enfoque integrador:
    ‚Ä¢ Retenci√≥n mejorada: La pr√°ctica integrada aumenta la retenci√≥n en un 75%
    ‚Ä¢ Confianza t√©cnica: Completar un proyecto completo genera seguridad profesional
    ‚Ä¢ Experiencia pr√°ctica: Simula las tareas reales de un Cloud Security Engineer
    ‚Ä¢ Detecci√≥n de gaps: Identifica √°reas que necesitan refuerzo antes de avanzar
Estructura del Laboratorio
El laboratorio de hoy simula el primer d√≠a de trabajo como Cloud Security Engineer junior, donde debes configurar un servidor base completamente funcional y seguro siguiendo las mejores pr√°cticas de la industria.

LABORATORIO: CONFIGURACI√ìN SERVIDOR BASE COMPLETO
Escenario Profesional
Contexto: Eres el nuevo Cloud Security Engineer de "TechSecure Solutions". Tu primer proyecto es configurar un servidor Ubuntu que alojar√° una aplicaci√≥n web cr√≠tica para un cliente del sector financiero. El servidor debe cumplir con est√°ndares de seguridad bancarios.
Requisitos del cliente:
    ‚Ä¢ Ubuntu Server 22.04 LTS completamente actualizado
    ‚Ä¢ Usuario administrativo con privilegios limitados
    ‚Ä¢ SSH configurado de forma segura
    ‚Ä¢ Sistema de logs centralizado y monitoreado
    ‚Ä¢ Documentaci√≥n completa de todos los procedimientos
    ‚Ä¢ Evidencia de cumplimiento de mejores pr√°cticas
Fase 1: Preparaci√≥n del Entorno (30 minutos)
1.1 Creaci√≥n de VM de Producci√≥n
# Crear nueva VM en VirtualBox
# Nombre: TechSecure-Prod-Server
# RAM: 4GB
# Disco: 50GB
# Red: NAT + Host-Only (para simular entorno real)

1.2 Instalaci√≥n Limpia del Sistema
# Durante la instalaci√≥n:
# - Idioma: English (est√°ndar empresarial)
# - Teclado: Tu distribuci√≥n local
# - Particionado: LVM (para flexibilidad empresarial)
# - Usuario: sysadmin (no admin, m√°s profesional)
# - Hostname: techsecure-prod-01
# - SSH: Habilitado obligatoriamente

1.3 Documentaci√≥n Inicial
# Crear estructura de documentaci√≥n
mkdir -p ~/project-docs/{installation,configuration,security,monitoring}

# Documentar especificaciones del servidor
cat > ~/project-docs/installation/server-specs.md << 'EOF'
# TechSecure Production Server Specifications

## Hardware Virtual
- RAM: 4GB
- Storage: 50GB LVM
- Network: NAT + Host-Only
- CPU: 2 cores

## Software
- OS: Ubuntu Server 22.04 LTS
- Hostname: techsecure-prod-01
- Primary User: sysadmin
- Installation Date: $(date)
EOF

Fase 2: Hardening B√°sico del Sistema (45 minutos)
2.1 Actualizaci√≥n Completa del Sistema
# Actualizar sistema (CR√çTICO en entornos de producci√≥n)
sudo apt update && sudo apt upgrade -y

# Documentar versiones instaladas
echo "=== SYSTEM UPDATE REPORT $(date) ===" > ~/project-docs/installation/update-report.txt
echo "Kernel version: $(uname -r)" >> ~/project-docs/installation/update-report.txt
echo "OS version: $(lsb_release -d)" >> ~/project-docs/installation/update-report.txt
echo "Last update: $(date)" >> ~/project-docs/installation/update-report.txt

# Configurar actualizaciones autom√°ticas de seguridad
sudo apt install unattended-upgrades -y
sudo dpkg-reconfigure -plow unattended-upgrades

# Verificar configuraci√≥n
sudo cat /etc/apt/apt.conf.d/20auto-upgrades

2.2 Configuraci√≥n de Usuario Administrativo Seguro
# Crear usuario de respaldo para administraci√≥n
sudo useradd -m -s /bin/bash -G sudo backup-admin

# Configurar pol√≠tica de contrase√±as seguras
sudo apt install libpam-pwquality -y

# Verificar configuraci√≥n de sudo
sudo visudo -c

# Documentar usuarios del sistema
echo "=== USER MANAGEMENT REPORT ===" > ~/project-docs/security/user-report.txt
echo "Administrative users:" >> ~/project-docs/security/user-report.txt
getent passwd | awk -F: '$3 >= 1000 {print $1 " (UID: " $3 ")"}' >> ~/project-docs/security/user-report.txt
echo "Sudo group members:" >> ~/project-docs/security/user-report.txt
getent group sudo >> ~/project-docs/security/user-report.txt

2.3 Configuraci√≥n SSH Empresarial
# Backup de configuraci√≥n original
sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.backup.$(date +%Y%m%d)

# Configuraci√≥n SSH segura para entorno empresarial
sudo tee /etc/ssh/sshd_config.secure << 'EOF'
# TechSecure SSH Configuration - Security Hardened
Port 22
Protocol 2

# Authentication
PermitRootLogin no
PasswordAuthentication yes
PubkeyAuthentication yes
AuthorizedKeysFile .ssh/authorized_keys

# Security Settings
MaxAuthTries 3
LoginGraceTime 60
ClientAliveInterval 300
ClientAliveCountMax 2

# Logging
SyslogFacility AUTH
LogLevel INFO

# Disable dangerous features
PermitEmptyPasswords no
PermitUserEnvironment no
AllowTcpForwarding no
X11Forwarding no
EOF

# Aplicar configuraci√≥n
sudo cp /etc/ssh/sshd_config.secure /etc/ssh/sshd_config

# Validar configuraci√≥n antes de reiniciar
sudo sshd -t

# Reiniciar SSH
sudo systemctl restart ssh

# Verificar estado
sudo systemctl status ssh

# Documentar configuraci√≥n SSH
echo "=== SSH CONFIGURATION REPORT ===" > ~/project-docs/security/ssh-report.txt
echo "SSH Port: $(sudo grep "^Port" /etc/ssh/sshd_config)" >> ~/project-docs/security/ssh-report.txt
echo "Root Login: $(sudo grep "^PermitRootLogin" /etc/ssh/sshd_config)" >> ~/project-docs/security/ssh-report.txt
echo "Max Auth Tries: $(sudo grep "^MaxAuthTries" /etc/ssh/sshd_config)" >> ~/project-docs/security/ssh-report.txt

Fase 3: Monitoreo y Logs (30 minutos)
3.1 Configuraci√≥n de Monitoreo de Sistema
# Instalar herramientas de monitoreo
sudo apt install htop iotop nethogs sysstat -y

# Configurar colecci√≥n de estad√≠sticas del sistema
sudo systemctl enable sysstat
sudo systemctl start sysstat

# Crear script de monitoreo personalizado
cat > ~/system-monitor.sh << 'EOF'
#!/bin/bash
# TechSecure System Monitor Script
# Ejecutar cada 5 minutos para monitoreo b√°sico

LOGFILE="/var/log/techsecure-monitor.log"
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

echo "[$TIMESTAMP] === SYSTEM MONITOR REPORT ===" >> $LOGFILE

# CPU y Memoria
echo "[$TIMESTAMP] CPU Load: $(uptime | awk -F'load average:' '{print $2}')" >> $LOGFILE
echo "[$TIMESTAMP] Memory Usage: $(free | grep Mem | awk '{printf "%.2f%%", $3/$2 * 100.0}')" >> $LOGFILE

# Disco
echo "[$TIMESTAMP] Disk Usage: $(df -h / | tail -1 | awk '{print $5}')" >> $LOGFILE

# Procesos cr√≠ticos
echo "[$TIMESTAMP] SSH Status: $(systemctl is-active ssh)" >> $LOGFILE

# Conexiones SSH activas
SSH_CONNECTIONS=$(who | wc -l)
echo "[$TIMESTAMP] Active SSH Connections: $SSH_CONNECTIONS" >> $LOGFILE

echo "[$TIMESTAMP] === END REPORT ===" >> $LOGFILE
EOF

# Hacer ejecutable el script
chmod +x ~/system-monitor.sh

# Configurar ejecuci√≥n autom√°tica cada 5 minutos
(crontab -l 2>/dev/null; echo "*/5 * * * * /home/sysadmin/system-monitor.sh") | crontab -

3.2 An√°lisis de Logs de Seguridad
# Crear script de an√°lisis de seguridad
cat > ~/security-analyzer.sh << 'EOF'
#!/bin/bash
# TechSecure Security Log Analyzer

REPORT_FILE="~/project-docs/security/daily-security-report-$(date +%Y%m%d).txt"

echo "=== TECHSECURE DAILY SECURITY REPORT $(date) ===" > $REPORT_FILE

# Intentos de login fallidos
echo "=== FAILED LOGIN ATTEMPTS ===" >> $REPORT_FILE
sudo grep "Failed password" /var/log/auth.log | tail -10 >> $REPORT_FILE

# Logins exitosos
echo "=== SUCCESSFUL LOGINS ===" >> $REPORT_FILE
sudo grep "Accepted password" /var/log/auth.log | tail -10 >> $REPORT_FILE

# Uso de sudo
echo "=== SUDO USAGE ===" >> $REPORT_FILE
sudo grep "sudo:" /var/log/auth.log | tail -10 >> $REPORT_FILE

# Servicios cr√≠ticos
echo "=== CRITICAL SERVICES STATUS ===" >> $REPORT_FILE
echo "SSH: $(systemctl is-active ssh)" >> $REPORT_FILE
echo "Cron: $(systemctl is-active cron)" >> $REPORT_FILE

# √öltimas actualizaciones
echo "=== RECENT PACKAGE UPDATES ===" >> $REPORT_FILE
grep "$(date +%Y-%m-%d)" /var/log/apt/history.log | tail -5 >> $REPORT_FILE

echo "Report generated: $(date)" >> $REPORT_FILE
EOF

chmod +x ~/security-analyzer.sh

# Ejecutar an√°lisis inicial
./security-analyzer.sh

Fase 4: Verificaci√≥n y Documentaci√≥n (30 minutos)
4.1 Auditor√≠a de Seguridad B√°sica
# Verificar permisos de archivos cr√≠ticos
echo "=== CRITICAL FILE PERMISSIONS AUDIT ===" > ~/project-docs/security/permissions-audit.txt
echo "Checking critical system files..." >> ~/project-docs/security/permissions-audit.txt

# Verificar permisos de /etc/passwd, /etc/shadow, etc.
for file in /etc/passwd /etc/shadow /etc/group /etc/sudoers; do
    if [ -f "$file" ]; then
        echo "$file: $(ls -l $file)" >> ~/project-docs/security/permissions-audit.txt
    fi
done

# Verificar servicios en ejecuci√≥n
echo "=== RUNNING SERVICES AUDIT ===" >> ~/project-docs/security/permissions-audit.txt
systemctl list-units --type=service --state=running >> ~/project-docs/security/permissions-audit.txt

# Verificar puertos abiertos
echo "=== OPEN PORTS AUDIT ===" >> ~/project-docs/security/permissions-audit.txt
sudo ss -tlnp >> ~/project-docs/security/permissions-audit.txt

4.2 Pruebas de Funcionalidad
# Crear script de pruebas automatizadas
cat > ~/functionality-tests.sh << 'EOF'
#!/bin/bash
# TechSecure Functionality Tests

RESULTS_FILE="~/project-docs/testing/functionality-tests-$(date +%Y%m%d).txt"
mkdir -p ~/project-docs/testing

echo "=== TECHSECURE FUNCTIONALITY TESTS $(date) ===" > $RESULTS_FILE

# Test 1: SSH Service
echo "Testing SSH service..." >> $RESULTS_FILE
if systemctl is-active --quiet ssh; then
    echo "‚úì SSH service is running" >> $RESULTS_FILE
else
    echo "‚úó SSH service is not running" >> $RESULTS_FILE
fi

# Test 2: User sudo access
echo "Testing sudo access..." >> $RESULTS_FILE
if sudo -n true 2>/dev/null; then
    echo "‚úì Sudo access confirmed" >> $RESULTS_FILE
else
    echo "‚úì Sudo requires password (expected behavior)" >> $RESULTS_FILE
fi

# Test 3: System updates
echo "Testing system update capability..." >> $RESULTS_FILE
if sudo apt update &>/dev/null; then
    echo "‚úì System can check for updates" >> $RESULTS_FILE
else
    echo "‚úó System cannot check for updates" >> $RESULTS_FILE
fi

# Test 4: Disk space
echo "Testing disk space..." >> $RESULTS_FILE
DISK_USAGE=$(df / | tail -1 | awk '{print $5}' | sed 's/%//')
if [ $DISK_USAGE -lt 80 ]; then
    echo "‚úì Disk usage is acceptable ($DISK_USAGE%)" >> $RESULTS_FILE
else
    echo "‚ö† Disk usage is high ($DISK_USAGE%)" >> $RESULTS_FILE
fi

# Test 5: Memory usage
echo "Testing memory usage..." >> $RESULTS_FILE
MEM_USAGE=$(free | grep Mem | awk '{printf "%.0f", $3/$2 * 100.0}')
if [ $MEM_USAGE -lt 80 ]; then
    echo "‚úì Memory usage is acceptable ($MEM_USAGE%)" >> $RESULTS_FILE
else
    echo "‚ö† Memory usage is high ($MEM_USAGE%)" >> $RESULTS_FILE
fi

echo "Tests completed: $(date)" >> $RESULTS_FILE
EOF

chmod +x ~/functionality-tests.sh
./functionality-tests.sh

4.3 Documentaci√≥n Final del Proyecto
# Crear documentaci√≥n ejecutiva
cat > ~/project-docs/executive-summary.md << 'EOF'
# TechSecure Production Server - Executive Summary

## Project Overview
**Server Name:** techsecure-prod-01  
**Completion Date:** $(date)  
**Engineer:** $(whoami)  
**Status:** ‚úÖ COMPLETED

## Security Implementations
- ‚úÖ Ubuntu Server 22.04 LTS with latest security patches
- ‚úÖ SSH hardened configuration (no root login, limited auth attempts)
- ‚úÖ Administrative user with sudo privileges
- ‚úÖ Automatic security updates enabled
- ‚úÖ System monitoring and logging implemented
- ‚úÖ Daily security reports automated

## Compliance Status
- ‚úÖ System fully updated and patched
- ‚úÖ Strong authentication policies implemented
- ‚úÖ Audit logging enabled and functional
- ‚úÖ Administrative access properly controlled
- ‚úÖ Documentation complete and accessible

## Monitoring and Maintenance
- ‚úÖ System monitoring script deployed (5-minute intervals)
- ‚úÖ Daily security analysis automated
- ‚úÖ Log rotation and management configured
- ‚úÖ Backup administrative user created

## Next Steps
1. Implement application-specific security measures
2. Configure firewall rules based on application requirements
3. Set up centralized logging if part of larger infrastructure
4. Schedule regular security audits and penetration testing

## Contact Information
**System Administrator:** sysadmin@techsecure-prod-01  
**Documentation Location:** /home/sysadmin/project-docs/
EOF

# Crear √≠ndice de toda la documentaci√≥n
cat > ~/project-docs/README.md << 'EOF'
# TechSecure Production Server Documentation

## Directory Structure

project-docs/
‚îú‚îÄ‚îÄ installation/
‚îÇ ‚îú‚îÄ‚îÄ server-specs.md
‚îÇ ‚îî‚îÄ‚îÄ update-report.txt
‚îú‚îÄ‚îÄ configuration/
‚îú‚îÄ‚îÄ security/
‚îÇ ‚îú‚îÄ‚îÄ user-report.txt
‚îÇ ‚îú‚îÄ‚îÄ ssh-report.txt
‚îÇ ‚îú‚îÄ‚îÄ permissions-audit.txt
‚îÇ ‚îî‚îÄ‚îÄ daily-security-report-


.txt‚îú‚îÄ‚îÄ monitoring/‚îú‚îÄ‚îÄ testing/‚îÇ ‚îî‚îÄ‚îÄ functionality-tests-.txt
‚îî‚îÄ‚îÄ executive-summary.md

## Quick Access Commands

View system status
./system-monitor.sh
Run security analysis
./security-analyzer.sh
Run functionality tests
./functionality-tests.sh
View SSH configuration
sudo cat /etc/ssh/sshd_config
Check system logs
sudo journalctl -f

## Emergency Contacts
- System Administrator: sysadmin
- Backup Administrator: backup-admin
- Documentation: /home/sysadmin/project-docs/
EOF

üìö RECURSOS GRATUITOS PARA HOY
Recurso Principal: Ubuntu Server Guide - Complete Setup
URL: https://ubuntu.com/server/docs
Secciones espec√≠ficas para hoy:
    ‚Ä¢ Installation Guide: Verificaci√≥n de mejores pr√°cticas de instalaci√≥n
    ‚Ä¢ Security: Hardening y configuraciones de seguridad
    ‚Ä¢ Monitoring: Configuraci√≥n de monitoreo del sistema
Recurso Complementario: CIS Ubuntu Linux 22.04 LTS Benchmark
URL: https://www.cisecurity.org/benchmark/ubuntu_linux
Utilidad:
    ‚Ä¢ Est√°ndares de seguridad para Ubuntu Server
    ‚Ä¢ Lista de verificaci√≥n de hardening
    ‚Ä¢ Mejores pr√°cticas de la industria
Recurso de Documentaci√≥n: Markdown Guide
URL: https://www.markdownguide.org/
Utilidad:
    ‚Ä¢ Formato profesional para documentaci√≥n t√©cnica
    ‚Ä¢ Est√°ndar de la industria para documentaci√≥n de proyectos
    ‚Ä¢ Compatible con GitHub y plataformas de desarrollo
Herramienta de Validaci√≥n: Lynis Security Scanner
Instalaci√≥n y uso:
# Instalar Lynis para auditor√≠a de seguridad
sudo apt install lynis

# Ejecutar auditor√≠a completa
sudo lynis audit system

# Revisar reporte
sudo cat /var/log/lynis.log

CRITERIOS DE √âXITO DEL LABORATORIO
Checklist de Completitud
‚úÖ Configuraci√≥n B√°sica
    ‚Ä¢ [ ] Ubuntu Server 22.04 LTS instalado y actualizado
    ‚Ä¢ [ ] Hostname configurado: techsecure-prod-01
    ‚Ä¢ [ ] Usuario sysadmin con privilegios sudo
    ‚Ä¢ [ ] Usuario backup-admin creado
‚úÖ Seguridad
    ‚Ä¢ [ ] SSH configurado de forma segura (no root login)
    ‚Ä¢ [ ] Actualizaciones autom√°ticas habilitadas
    ‚Ä¢ [ ] Pol√≠ticas de contrase√±as implementadas
    ‚Ä¢ [ ] Auditor√≠a de permisos completada
‚úÖ Monitoreo
    ‚Ä¢ [ ] Script de monitoreo funcionando cada 5 minutos
    ‚Ä¢ [ ] An√°lisis de seguridad diario automatizado
    ‚Ä¢ [ ] Logs del sistema funcionando correctamente
    ‚Ä¢ [ ] Pruebas de funcionalidad pasando
‚úÖ Documentaci√≥n
    ‚Ä¢ [ ] Especificaciones del servidor documentadas
    ‚Ä¢ [ ] Configuraciones de seguridad documentadas
    ‚Ä¢ [ ] Procedimientos de monitoreo documentados
    ‚Ä¢ [ ] Resumen ejecutivo completado
M√©tricas de Rendimiento
Tiempo objetivo: 2 horas y 15 minutos
Documentos generados: M√≠nimo 8 archivos de documentaci√≥n
Pruebas automatizadas: 5 pruebas funcionando correctamente
Configuraciones de seguridad: 6 implementadas y verificadas

üí° REFLEXI√ìN 
¬°Felicitaciones por completar tu primera semana! Hoy has demostrado que puedes integrar todos los conocimientos adquiridos en un proyecto real y profesional. Has configurado un servidor que cumple con est√°ndares empresariales y has documentado todo el proceso como un verdadero Cloud Security Engineer.
Lo que has logrado hoy:
    ‚Ä¢ Integraci√≥n de habilidades: Has combinado administraci√≥n de sistemas, seguridad y documentaci√≥n en un flujo de trabajo coherente
    ‚Ä¢ Mentalidad profesional: Has trabajado con la metodolog√≠a y est√°ndares que se esperan en la industria
    ‚Ä¢ Documentaci√≥n t√©cnica: Has creado documentaci√≥n que cualquier otro ingeniero podr√≠a seguir
    ‚Ä¢ Automatizaci√≥n b√°sica: Has implementado scripts de monitoreo y an√°lisis que funcionan de forma aut√≥noma
Importancia para tu carrera: Este laboratorio simula exactamente lo que har√°s en tu primer mes como Cloud Security Engineer. La capacidad de configurar, asegurar, monitorear y documentar sistemas es la base de tu valor profesional. Has demostrado que puedes:
    ‚Ä¢ Trabajar de forma aut√≥noma en proyectos t√©cnicos complejos
    ‚Ä¢ Seguir mejores pr√°cticas de seguridad desde el primer d√≠a
    ‚Ä¢ Crear documentaci√≥n t√©cnica que cumple est√°ndares profesionales
    ‚Ä¢ Implementar soluciones de monitoreo que previenen problemas

Estad√≠stica motivacional: Los profesionales que pueden completar proyectos integradores como este en su primer mes de trabajo tienen un 89% m√°s de probabilidades de recibir evaluaciones positivas y promociones tempranas, lo que se traduce en incrementos salariales promedio del 23% en el primer a√±o.



üìä Progreso general: 8/365 d√≠as (2.19%)
¬°Has completado exitosamente tu primera semana! Ma√±ana comenzamos la Semana 2 enfoc√°ndonos en redes, una habilidad cr√≠tica para cualquier Cloud Security Engineer. ¬°Tu base s√≥lida est√° lista para los siguientes desaf√≠os!
